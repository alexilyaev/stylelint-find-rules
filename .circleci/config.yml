# Javascript Node CircleCI 2.0 configuration file
#
# Check https://circleci.com/docs/2.0/language-javascript/ for more details
#

version: 2

# YAML Anchors and Aliases
# https://circleci.com/docs/2.0/writing-yaml/
# https://circleci.com/blog/circleci-hacks-reuse-yaml-in-your-circleci-config-with-yaml/

# Download and cache dependencies
# https://circleci.com/docs/2.0/yarn/
# https://circleci.com/docs/2.0/caching/
_restore_yarn_cache: &restore_yarn_cache
  keys:
    - yarn-packages-{{ checksum "yarn.lock" }}

_save_yarn_cache: &save_yarn_cache
  key: yarn-packages-{{ checksum "yarn.lock" }}
  paths:
    - ~/.cache/yarn

_defaults: &defaults
  steps:
    - checkout
    - restore_cache: *restore_yarn_cache
    - run: yarn install --frozen-lockfile
    - save_cache: *save_yarn_cache
    - run: npm run lint

# Setup

jobs:
  node-v10:
    <<: *defaults

    docker:
      - image: circleci/node:10.16.1

  node-v8:
    <<: *defaults

    docker:
      - image: circleci/node:8.6.0

workflows:
  version: 2
  node-multi-build:
    jobs:
      - node-v10
      - node-v8
